(self.webpackChunk=self.webpackChunk||[]).push([[7444],{88070:(e,t,s)=>{s.r(t),s.d(t,{TranslatePageIntegration:()=>g});var i,a=s(90023),n=s(82823),r=s(58303),o=s(25770),d=s(81259),h=s(70886);!function(e){e.create=function(e,t){return(0,a.zG)({domain:e,disableTranslateOnboarding:()=>{t.toggleTranslateOnboardingForDomain({domain:e,enabled:!1})}},r.G)}}(i||(i={}));var l=s(4603),_=s(68970),c=s(25624),p=s(70932);class g{constructor(e,t,s,i,a){this._context=e,this._state=t,this._actions=s,this._telemetry=i,this._gnar=a,this._disposed=o.h.create(!1),this.disposed=this._disposed,this._subscriptions=new n.w,this._disposables=[];new URL(this._context.url).searchParams.get("resetTranslate")&&(p.Y.create("TranslateOnboarding").trace("Reset Translation Onboarding"),this._actions.patchCommonSettings({translateOnboarding:c.aK.empty})),this._builderCSState=o.h.create(this._state.page.translateOnboarding||c.aK.empty)}async init(){return await(0,l.OB)().bgRpc.api.translateCheckAvailability(this._state.user.id)&&!(0,_.n_)()&&(0,h.jd)(this._state.page.domain,this._state.page)&&"test"===this._context.experimentClient.getTreatment(d.p.TranslationDiscoverability)?(this._model=i.create(this._state.page.domain,this._actions),(0,a.zG)(this._model,r.g_((()=>(this.dispose(),Promise.resolve())),(e=>this._inject(e,this._telemetry,(0,h.sh)(this._gnar)).catch((e=>{this._telemetry.translateOnboarding.error("unexpectedInjected","Unexpected error while injecting",(0,h.js)(),e)})))))):Promise.resolve()}_inject(e,t,i){return Promise.all([Promise.all([s.e(2467),s.e(6523),s.e(8368),s.e(9536),s.e(7172)]).then(s.bind(s,38348)),Promise.all([s.e(2467),s.e(6523),s.e(8368),s.e(9536),s.e(7172)]).then(s.bind(s,17665)),Promise.all([s.e(2467),s.e(6523),s.e(8368),s.e(9536),s.e(7172)]).then(s.bind(s,45801))]).then((([{createTranslateOnboardingViewModel:s},{TranslateIntegrationLayout:a},{TranslateOnboardingView:n}])=>{this._viewModel=s({csState:this._state,model:e,gnar:i}),this._disposables.push(this._viewModel),this._layout=new a,this._disposables.push(this._layout.render(n,this._viewModel,(0,l.OB)())),t.translateOnboarding.info("init","Translate onboarding initiated",(0,h.js)())}))}update(e){e.page.translateOnboarding&&this._builderCSState.set(e.page.translateOnboarding),(0,h.jd)(e.page.domain,e.page)||this.dispose()}dispose(){this._disposables.forEach((e=>e.dispose())),this._disposed.set(!0),this._subscriptions.unsubscribe()}}}}]);