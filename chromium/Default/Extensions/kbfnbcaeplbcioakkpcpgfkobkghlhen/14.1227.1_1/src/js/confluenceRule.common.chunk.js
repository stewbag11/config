(self.webpackChunk=self.webpackChunk||[]).push([[370],{45345:(e,t,n)=>{n.d(t,{v:()=>F});var a=n(81259),i=n(38684),r=n(90023),o=n(12518),c=n(44949),l=n(17071),s=n(65384),d=n(62958),u=n(87086),p=n(6088),g=n(5614);var m=n(58303),v=n(25770),f=n(73104),h=n(34854),x=n(50978);const C=e=>e.createDocument?e.createDocument:t=>x._A.create((e=>e.getDocumentId?e.getDocumentId:()=>{})(e)(t));var y=n(18845),S=n(35509),E=n(44806);const b={ruleName:"isKnowledgeHubEnabled",match:(e,t)=>"test"===t.experimentClient.getTreatment(a.p.KnowledgeHubAtlassian)},M=".ak-renderer-document",F=(I="Jira",T=e=>({createLayout:()=>new i.A7(e.field),validationRules:[b,{ruleName:"isReadonlyContentField",match:(e,t)=>e.matches(M)}],textMap:{createFieldTextMap:e=>new p.Z(e,((e,t)=>p.Z.defaultFilterNode(e,t)&&(e=>!e.classList.contains("expand-content-wrapper"))(e)))}}),w=M,{kind:E.A.readonly,name:`readonlyContent.${I}`,contentSelector:w,match:e=>{const t=((e,t,n,a)=>{const i=n(e),o=i.target||e.field,c=i.textMap||{createFieldTextMap:p.Z.create},m=(i.createSelectionSource||(()=>(0,u.B)(o)))();return{target:o,initialState:e.state,integrationName:`contentEditable.${t}`,validationRules:[{ruleName:"notABody",match:(0,l.ff)(d.XD)},{ruleName:"isReadonlyContentField",match:(e,t)=>e.matches(a)}],textMap:c,expiration:d.Jj,createSelectionSource:()=>(0,u.B)(o),mapChange:r.yR,...i,selectionSource:m,createTextObserver:()=>new g.j(o,s.k.fromDiff,m,void 0,c.createFieldTextMap)}})(e,I,T,w);return(0,r.zG)((0,y.O)(t.target,e,t.integrationName,t.validationRules),o.map((()=>({targetField:t.target,matchExpires:t.expiration(t.target),execute:e=>{var n;const a=S.Y.decorate((0,r.zG)(((e,t)=>{var n;const a=t.createTextObserver(),i=t.createHighlightsFilterFactory?t.createHighlightsFilterFactory(a):h.u,r=t.createLayout(t.target);return{doc:C(e)(t.target),textField:t.target,domain:e.pageContext.domain,url:e.pageContext.url,layout:r,createCheckingService:t=>e.createCheckingService(t),mapChange:t.mapChange,state:v.h.create(t.initialState),actions:e.actions,fieldSettings:e.fieldSettings,notifications:(0,f.Cq)(e.app.notifications,"ctx.app.notifications"),gnar:e.gnar,productMetricsCSClient:e.productMetricsCSClient,felog:e.felog,config:e.pageContext.config,experimentClient:e.experimentClient,isCurrentFieldFocused:v.h.create(!1),selectionSource:t.selectionSource,textObserver:a,createAlertProcessor:t.createAlertProcessor,createTextRevisionManager:t.createTextRevisionManager,geometryProvider:t.highlightGeometryProvider,customizations:{...t.customizations,getDocEvents:(null===(n=t.customizations)||void 0===n?void 0:n.getDocEvents)||e.getDocEvents,isGbuttonVisible:v.h.create(!1)},highlightsFilterFactory:i,iframeConnectionId:e.iframeConnectionId,eventPropagationHandler:e.eventPropagationHandler,forceIntegrationEntirelyInsideIframe:e.forceIntegrationEntirelyInsideIframe,pageIntegrationId:e.pageContext.id,integrationName:t.integrationName,fieldIntegrationStore:e.pageContext.fieldIntegrationStore,vBarsIntegrationInfo:m.YP}})(e,t),c.kC,r.a9),t.integrationName,t.target);return null===(n=t.onCreate)||void 0===n||n.call(t),{update(e){a.update(e)},dispose(){var e;a.dispose(),null===(e=t.onDispose)||void 0===e||e.call(t)}}},desiredCustomizations:{capiStartSessionOptions:{...e.capiStartSessionOptions,mode:"READ_ONLY"}}}))))}});var I,T,w},47191:(e,t,n)=>{n.r(t),n.d(t,{Confluence:()=>I});var a,i=n(21885),r=n(65882),o=n(64965),c=n(18615),l=n(34859),s=n(14765),d=n(65647),u=n(70989),p=n(60165),g=n(70163),m=n(43456),v=n(73104),f=n(4603),h=n(38684),x=n(72779),C=n(41637),y=n(62958),S=n(75629),E=n(395),b=n(59898),M=n(45345),F=n(6088);!function(e){e.createEditorTextMap=e=>new F.Z(e,void 0,void 0,((e,t)=>t.isEditable))}(a||(a={}));var I,T=n(37094),w=n(55793),R=n(91795),N=n(74081),A=n(4798);!function(e){const t=S.T.iframe("Confluence.confluenceEditor",(e=>({validationRules:[{ruleName:"TinyMCECustomRule",match:e=>{var t;const n=null===(t=null==e?void 0:e.contentDocument)||void 0===t?void 0:t.body;return!!n&&((0,y.Ne)(n)||(0,y.w5)(n))}},...b.c],expiration:(e,t)=>{const n=e.parentElement&&e.parentElement.parentElement;return n&&"wysiwyg"===n.id?R.x.observeAttribute(n,"class").pipe((0,c.P)((e=>!!e&&e.includes("hidden"))),(0,l.h)(void 0)):(0,i.F)()},textMap:{createFieldTextMap:a.createEditorTextMap}}))),n=E.M.generic((e=>({overwriteGenericOpts:{validationRules:b.u,textMap:{createFieldTextMap:(e,t={})=>E.M.createFieldTextMap(e,{...t,andFilterNode:e=>{const t=e.getAttribute("data-testid");return!t||!t.includes("placeholder")}})},createLayout:e=>{const t=(0,x.bp)(e),n=N.N.observeSizeChanges([e,t]),a=(0,v.Cq)(e.parentElement),i=R.x.create(a,{attributes:!1,childList:!0,subtree:!1,characterData:!1}).pipe((0,s.O)([]),(0,d.U)((()=>{const e=t.querySelector("#editor-scroll-gutter");return e?e.clientHeight:0})));return new h.A7(e,{createGbuttonShiftBehavior:e=>(0,r.aj)(n.pipe((0,u.M)(i),(0,d.U)((([e,n])=>{const a=t.getBoundingClientRect(),i=t.scrollHeight-a.height-n-(self.innerHeight-a.bottom);if(0===i)return 0;return i+36})),(0,p.x)()),(0,o.R)(t,"scroll").pipe((0,d.U)((()=>t.scrollTop)),(0,s.O)(t.scrollTop),(0,p.x)(),(0,g.B)())).pipe((0,d.U)((([e,t])=>({top:Math.min(0,t-e),left:0}))),(0,m.d)()),injectIntegrationRoot:({editorElement:e,isPositioned:t,editorElementStyle:n,integrationRoot:a,positionedAncestor:i})=>{t?(a.style.zIndex=n.zIndex,e.insertAdjacentElement("afterend",a)):(a.style.zIndex="1",i.insertAdjacentElement("beforeend",a))}})}}})));e.page=(0,T.$W)({name:"confluence",domain:w.fI,url:/^https?:\/\/\S+\.atlassian\.net\/wiki\/.*$/,eventPropagationHandler:e=>{(0,f.OB)().experimentClient.isGateEnabled(A.K.CentralizeStopEventPropagation)||e.addEventListener("keypress",(e=>{e.stopPropagation()}))}},[n,S.T.contentEditable("Confluence",(()=>({createLayout:e=>new C.K(e)}))),t,S.T.iframe("Confluence"),S.T.textarea("Confluence",(()=>({createLayout:e=>new C.K(e)}))),M.v])}(I||(I={}))}}]);