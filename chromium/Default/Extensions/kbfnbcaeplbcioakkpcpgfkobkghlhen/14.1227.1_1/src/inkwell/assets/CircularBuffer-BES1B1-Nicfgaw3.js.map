{"version":3,"file":"CircularBuffer-BES1B1-Nicfgaw3.js","sources":["../../../util-array/dist/CircularBuffer-BES1B1.mjs"],"sourcesContent":["/**\n * Circular buffer implementation.\n * Items can be added a the end (push) or removed from the front (shift).\n * When the capacity is reached, items are removed from the front automatically.\n * @public\n */\nclass CircularBuffer {\n    #capacity;\n    #buffer = [];\n    #start = 0;\n    #end = 0;\n    #length = 0;\n    constructor(options) {\n        this.#capacity = options.capacity;\n    }\n    /**\n     * The number of items in the buffer\n     */\n    get length() {\n        return this.#length;\n    }\n    /**\n     * Whether the buffer is full\n     */\n    get isFull() {\n        return this.#length === this.#capacity;\n    }\n    /**\n     * Index into the buffer\n     */\n    at(index) {\n        if (this.#length === 0)\n            return undefined;\n        const offset = index < 0 ? this.#length + index : index;\n        if (offset >= this.#length)\n            return undefined;\n        return this.#buffer[(this.#start + offset) % this.#capacity];\n    }\n    /**\n     * Push a new value to the buffer\n     * @returns If the buffer is full, a value is removed from the front and the value is returned\n     */\n    push(value) {\n        const front = this.#buffer[this.#start];\n        const isFull = this.isFull;\n        this.#buffer[this.#end] = value;\n        this.#length = Math.min(this.#length + 1, this.#capacity);\n        if (isFull && this.#start === this.#end) {\n            this.#start = (this.#start + 1) % this.#capacity;\n        }\n        this.#end = (this.#end + 1) % this.#capacity;\n        if (isFull)\n            return front;\n        else\n            return undefined;\n    }\n    /**\n     * Remove the first item from the buffer and return it\n     */\n    shift() {\n        if (this.#length === 0)\n            return undefined;\n        const front = this.#buffer[this.#start];\n        this.#start = (this.#start + 1) % this.#capacity;\n        this.#length--;\n        return front;\n    }\n    /**\n     * Apply a function to each item in the buffer\n     */\n    forEach(callbackfn) {\n        let i = 0;\n        for (const value of this) {\n            callbackfn(value, i++);\n        }\n    }\n    /**\n     * Apply a reducer function to the buffer's content\n     */\n    reduce(callbackfn, initialValue) {\n        let acc = initialValue;\n        let i = 0;\n        for (const value of this) {\n            acc = callbackfn(acc, value, i++);\n        }\n        return acc;\n    }\n    *[Symbol.iterator]() {\n        for (let i = 0; i < this.#length; i++) {\n            yield this.at(i);\n        }\n    }\n}\n\nexport { CircularBuffer };\n//# sourceMappingURL=CircularBuffer-BES1B1.mjs.map\n"],"names":["_capacity","_buffer","_start","_end","_length","CircularBuffer","options","__privateAdd","__privateSet","__privateGet","index","offset","value","front","isFull","__privateWrapper","callbackfn","i","initialValue","acc"],"mappings":"8YAAA,IAAAA,EAAAC,EAAAC,EAAAC,EAAAC,EAMA,MAAMC,CAAe,CAMjB,YAAYC,EAAS,CALrBC,EAAA,KAAAP,GACAO,EAAA,KAAAN,EAAU,CAAA,GACVM,EAAA,KAAAL,EAAS,GACTK,EAAA,KAAAJ,EAAO,GACPI,EAAA,KAAAH,EAAU,GAENI,EAAA,KAAKR,EAAYM,EAAQ,SAC5B,CAID,IAAI,QAAS,CACT,OAAOG,EAAA,KAAKL,EACf,CAID,IAAI,QAAS,CACT,OAAOK,EAAA,KAAKL,KAAYK,EAAA,KAAKT,EAChC,CAID,GAAGU,EAAO,CACN,GAAID,EAAA,KAAKL,KAAY,EACjB,OACJ,MAAMO,EAASD,EAAQ,EAAID,EAAA,KAAKL,GAAUM,EAAQA,EAClD,GAAI,EAAAC,GAAUF,EAAA,KAAKL,IAEnB,OAAOK,EAAA,KAAKR,IAASQ,EAAA,KAAKP,GAASS,GAAUF,EAAA,KAAKT,EAAS,CAC9D,CAKD,KAAKY,EAAO,CACR,MAAMC,EAAQJ,EAAA,KAAKR,GAAQQ,EAAA,KAAKP,EAAM,EAChCY,EAAS,KAAK,OAOpB,GANAL,EAAA,KAAKR,GAAQQ,EAAA,KAAKN,EAAI,EAAIS,EAC1BJ,EAAA,KAAKJ,EAAU,KAAK,IAAIK,EAAA,KAAKL,GAAU,EAAGK,EAAA,KAAKT,EAAS,GACpDc,GAAUL,EAAA,KAAKP,KAAWO,EAAA,KAAKN,IAC/BK,EAAA,KAAKN,GAAUO,EAAA,KAAKP,GAAS,GAAKO,EAAA,KAAKT,IAE3CQ,EAAA,KAAKL,GAAQM,EAAA,KAAKN,GAAO,GAAKM,EAAA,KAAKT,IAC/Bc,EACA,OAAOD,CAGd,CAID,OAAQ,CACJ,GAAIJ,EAAA,KAAKL,KAAY,EACjB,OACJ,MAAMS,EAAQJ,EAAA,KAAKR,GAAQQ,EAAA,KAAKP,EAAM,EACtC,OAAAM,EAAA,KAAKN,GAAUO,EAAA,KAAKP,GAAS,GAAKO,EAAA,KAAKT,IACvCe,EAAA,KAAKX,GAAL,IACOS,CACV,CAID,QAAQG,EAAY,CAChB,IAAIC,EAAI,EACR,UAAWL,KAAS,KAChBI,EAAWJ,EAAOK,GAAG,CAE5B,CAID,OAAOD,EAAYE,EAAc,CAC7B,IAAIC,EAAMD,EACND,EAAI,EACR,UAAWL,KAAS,KAChBO,EAAMH,EAAWG,EAAKP,EAAOK,GAAG,EAEpC,OAAOE,CACV,CACD,EAAE,OAAO,QAAQ,GAAI,CACjB,QAASF,EAAI,EAAGA,EAAIR,EAAA,KAAKL,GAASa,IAC9B,MAAM,KAAK,GAAGA,CAAC,CAEtB,CACL,CArFIjB,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA"}