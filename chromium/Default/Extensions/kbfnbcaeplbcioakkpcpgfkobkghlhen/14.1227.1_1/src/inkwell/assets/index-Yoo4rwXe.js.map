{"version":3,"file":"index-Yoo4rwXe.js","sources":["../../../feature-ui/src/index.ts"],"sourcesContent":["/**\n * This package provides a view container that allows placing content in the `<main>` element.\n * @packageDocumentation\n */\n\nimport type { Activate } from '@grammarly/feature'\nimport type { EmptyObject } from '@grammarly/ts-stdlib'\nimport { createInjectionToken } from '@grammarly/util-dependency-container'\nimport { pipe } from '@grammarly/util-function'\nimport { Result, ResultDisposable } from '@grammarly/util-result'\nimport { DefaultViewContainer, type ViewContainer } from '@grammarly/util-view-container'\nimport React from 'react'\n\n/**\n * The slots for the main ViewContainer.\n * @public\n */\nexport interface MainViewContainerSlots {\n  readonly default: never\n}\n\n/**\n * The main ViewContainer for placing content in the `<main>` element.\n * @public\n */\nexport type MainViewContainer = ViewContainer<MainViewContainerSlots>\n\n/**\n * Token to inject {@link MainViewContainer}.\n * @public\n */\nexport const MainViewContainerToken = createInjectionToken<MainViewContainer>(\n  Symbol('MainViewContainer'),\n)\n\n/**\n * Main view of the feature.\n * @public\n * @example\n * ```tsx\n * return (<main><MainView /></main>)\n * ```\n */\nexport type MainView = React.FC<EmptyObject>\n\n/**\n * Main view of the feature.\n * @public\n */\nexport const MainViewToken = createInjectionToken<MainView>(Symbol('MainView'))\n\n/** @public */\nexport const activate: Activate = context =>\n  pipe(\n    context.getExecutionScope('global'),\n    Result.flatMap(scope => {\n      const viewContainer = new DefaultViewContainer<MainViewContainerSlots>()\n      const MainView = () => {\n        const slots = React.useSyncExternalStore(viewContainer.subscribe, viewContainer.getSnapshot)\n        return React.createElement(\n          React.Fragment,\n          {},\n          slots.default?.map(slot => React.cloneElement(slot.view, { key: slot.key })),\n        )\n      }\n\n      return ResultDisposable.all([\n        scope.register({ token: MainViewContainerToken, useValue: viewContainer }),\n        scope.register({ token: MainViewToken, useValue: MainView }),\n      ])\n    }),\n  )\n"],"names":["MainViewContainerToken","createInjectionToken","MainViewToken","activate","context","pipe","Result.flatMap","scope","viewContainer","DefaultViewContainer","MainView","_a","slots","React","slot","ResultDisposable"],"mappings":"kLA+BO,MAAMA,EAAyBC,EACpC,OAAO,mBAAmB,CAC5B,EAgBaC,EAAgBD,EAA+B,OAAO,UAAU,CAAC,EAGjEE,EACXC,GAAAC,EACED,EAAQ,kBAAkB,QAAQ,EAClCE,EAAwBC,GAAA,CAChB,MAAAC,EAAgB,IAAIC,EACpBC,EAAW,IAAM,CAzD7B,IAAAC,EA0DQ,MAAMC,EAAQC,EAAM,qBAAqBL,EAAc,UAAWA,EAAc,WAAW,EAC3F,OAAOK,EAAM,cACXA,EAAM,SACN,CAAC,GACDF,EAAMC,EAAA,UAAN,KAAe,OAAAD,EAAA,IAAYG,GAAAD,EAAM,aAAaC,EAAK,KAAM,CAAE,IAAKA,EAAK,IAAK,CAAA,CAAA,CAC5E,EAGF,OAAOC,EAAiB,IAAI,CAC1BR,EAAM,SAAS,CAAE,MAAOP,EAAwB,SAAUQ,EAAe,EACzED,EAAM,SAAS,CAAE,MAAOL,EAAe,SAAUQ,EAAU,CAAA,CAC5D,CAAA,CACF,CACH"}